<!DOCTYPE html>
<html>
    <head>
        <title>Hellomouse Blog</title>
        <meta charset="utf-8">
        <meta name="description" content="Hellomouse Blog">
        <meta name="author" content="Bowserinator">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <!-- Social meta -->
        <meta property="og:title" content="Hellomouse Blog">
        <meta property="og:description" content="Blog about blog stuff.">
        <meta property="og:image" content="img/thumbnail.jpg">

        <!-- CSS -->
        <link rel="stylesheet" href="css/main.css">
        <link href="https://fonts.googleapis.com/css?family=PT+Sans|Gelasio|Inconsolata&display=swap" rel="stylesheet">

        <!-- KATEX -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">

        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>

        <!-- To automatically render math in text elements, include the auto-render extension: -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script>

        <!-- Additional styles for this -->
        <style>
            .toggle-btn {
                background-color: #eee;
                color: #999;
                transition: filter 0.2s, background-color 0.2s, color 0.2s;
            }

            .toggle-btn.active {
                background-color: #00c853;
                color: #222;
                filter: contrast(100%);
                transition: filter 0.2s, background-color 0.2s, color 0.2s;
            }
        </style>
    </head>
  
    <body>
        <h1 class="title"><a href="index.html">HELLOMOUSE BLOG</a></h1>
        <h5 class="subtitle">Questionable blog stuff</h5>

        <h1>Engineering BCTR (TPT Mod)</h1>

        <p>
            So in TPT I made a mod that adds bacteria with evolution and genes! However, engineering custom strains 
            of bacteria turned out to be a hassle, so here's a nice website you can play with to create bacteria. To 
            apply your genes, simply set the BCTR's ctype to the value below by using the PROP tool or the console.
        </p>

        <p>
            A link to the mod can be found at <a href="https://github.com/hellomouse/TPT-Science-Mod">https://github.com/hellomouse/TPT-Science-Mod</a>
        </p>

        <hr>

        <br>
        <h3>Editor</h3>

        <table style="text-align: left" class="padded-table">
            <tr>
                <td>Resistance type</td>
                <td class="toggle-group">
                    <button class="toggle-btn active">None</button>
                    <button class="toggle-btn">HEAT*</button>
                    <button class="toggle-btn">COLD</button>
                    <button class="toggle-btn">VIRS*</button>
                    <button class="toggle-btn">SOAP*</button>
                    <button class="toggle-btn">ACID</button>
                    <button class="toggle-btn">Eaten</button>
                    <button class="toggle-btn">Radiation*</button>
                </td>
            </tr>
            <tr>
                <td>Resistance value (0-15)</td>
                <td><input id="resval" onchange="update_genes()" type="number" min="0" max="15" value="0"></td>
            </tr>
            <tr>
                <td>Food type</td>
                <td class="toggle-group">
                    <button class="toggle-btn active">SUGR</button>
                    <button class="toggle-btn">YEST*</button>
                    <button class="toggle-btn">PLNT*</button>
                    <button class="toggle-btn">PHOT*</button>
                    <button class="toggle-btn">NEUT*</button>
                    <button class="toggle-btn">BCTR*</button>
                    <button class="toggle-btn">HEAT*</button>
                </td>
            </tr>
            <tr>
                <td>Metabolism (0-15)</td>
                <td><input id="metabolism" onchange="update_genes()" type="number" min="0" max="15" value="0"></td>
            </tr>
            <tr>
                <td>Spread vector</td>
                <td class="toggle-group">
                    <button class="toggle-btn active">LIQUID</button>
                    <button class="toggle-btn">STICKY</button>
                    <button class="toggle-btn">FLOAT</button>
                    <button class="toggle-btn">DISSOLVE</button>
                    <button class="toggle-btn">INJECT DNA*</button>
                </td>
            </tr>
            <tr>
                <td>Move speed (0-7)</td>
                <td><input id="move" type="number" onchange="update_genes()" min="0" max="7" value="0"></td>
            </tr>
            <tr>
                <td>Graphics</td>
                <td class="toggle-group">
                    <button class="toggle-btn active">BLUR*</button>
                    <button class="toggle-btn">SPARK</button>
                    <button class="toggle-btn">BLOB</button>
                    <button class="toggle-btn">FLAT</button>
                </td>
            </tr>
            <tr>
                <td>Glow?</td>
                <td class="toggle-group">
                    <button class="toggle-btn active">NO GLOW</button>
                    <button class="toggle-btn">GLOW</button>
                </td>
            </tr>
        </table>

        <br>
        <h3>Sequenced Genome</h3>
        <table class="padded-table" id="genes">
            <tr> <!-- No numbers allowed here in this row -->
                <td>Res. Type</td>
                <td>Res. Val</td>
                <td>Food</td>
                <td>Metabolism</td>
                <td>Spread</td>
                <td>Move speed</td>
                <td>Graphics</td>
                <td>Glow</td>
                <td>Unused</td>
            </tr>
            <tr style="font-size: 17pt">
                <td id="gene0">0000</td>
                <td id="gene1">0000</td>
                <td id="gene2">0000</td>
                <td id="gene3">0000</td >
                <td id="gene4">0000</td>
                <td id="gene5">000</td>
                <td id="gene6">000</td>
                <td id="gene7">0</td>
                <td id="gene8">00000</td>
            </tr>
        </table>

        <p>
            You can get bacteria by using the prop tool and setting this ctype
            <pre style="margin-left: 20px" id="ctype1">[the ctype]</pre>
            Or by using the console (~) and typing 
            <pre style="margin-left: 20px" id="ctype2">!set ctype bctr [the ctype]</pre style="margin-left: 20px">
        </p>

        <br>
        <h3>Properties</h3>
        <table class="padded-table" style="text-align: left">
            <tr>
                <td>Color</td>
                <td>
                    <div id="color" style="width: 60px; height: 20px"></div>
                </td>
            </tr>
            <tr>
                <td>Max temp</td>
                <td id="temp_max"></td>
            </tr>
            <tr>
                <td>Min temp</td>
                <td id="temp_min"></td>
            </tr>
            <tr>
                <td>Max age</td>
                <td id="age_max"></td>
            </tr>
            <tr>
                <td>Energy consumption</td>
                <td id="energy"></td>
            </tr>
            <tr>
                <td>Byproduct</td>
                <td id="byproduct"></td>
            </tr>
        </table>
        <br><hr>

        <script>
            let toggle_groups = [...document.getElementsByClassName('toggle-group')];
            let groups = [];
            let genes = [];

            // Gene values
            for (let i = 0; i <= 8; ++i)
                genes.push(document.getElementById('gene' + i));

            function padLeft(s, char, length) {
                while (s.length < length)
                    s = char + s;
                return s;
            }

            function getActiveIndex(group_id) {
                for (let i = 0; i < groups[group_id].length; ++i) {
                    if (groups[group_id][i].classList.contains('active'))
                        return i;
                }
                return 0;
            }

            function update_genes() {
                // Update gene binary chart
                genes[0].innerHTML = padLeft(getActiveIndex(0).toString(2), '0', 4);
                genes[1].innerHTML = padLeft((+document.getElementById('resval').value).toString(2), '0', 4);
                genes[2].innerHTML = padLeft(getActiveIndex(1).toString(2), '0', 4);
                genes[3].innerHTML = padLeft((+document.getElementById('metabolism').value).toString(2), '0', 4);
                genes[4].innerHTML = padLeft(getActiveIndex(2).toString(2), '0', 4);
                genes[5].innerHTML = padLeft((+document.getElementById('move').value).toString(2), '0', 3);
                genes[6].innerHTML = padLeft(getActiveIndex(3).toString(2), '0', 3);
                genes[7].innerHTML = padLeft(getActiveIndex(4).toString(2), '0', 1);

                let ctype = '';
                for (let i = 8; i >= 0; --i)
                    ctype += document.getElementById('gene' + i).innerText;
                ctype = parseInt(ctype, 2);
                document.getElementById('ctype1').innerHTML = ctype;
                document.getElementById('ctype2').innerHTML = '!set ctype bctr ' + ctype;

                // Color
                let [r, g, b] = [220, 247, 129];
                r = (r + (ctype << 4214) % 255) / 2;
                g = (g + 255 - r) / 2;
	            b = (b + (ctype << 12314) % 255) / 2;
                document.getElementById('color').style.backgroundColor = `rgb(${r}, ${g}, ${b})`;

                // Other prop
                document.getElementById('temp_max').innerHTML = 70 + 5 * (getActiveIndex(0) == 1) * (+document.getElementById('resval').value) + ' C';
                document.getElementById('temp_min').innerHTML = 0 - 5 * (getActiveIndex(0) == 2) * (+document.getElementById('resval').value) + ' C';
                document.getElementById('age_max').innerHTML = (15 - +document.getElementById('metabolism').value) * 90 + 300;
                document.getElementById('energy').innerHTML = +document.getElementById('metabolism').value +
                                                               +document.getElementById('move').value +
                                                               (getActiveIndex(4) == 1 ? 1 : 0) + 1;
                let byproduct = document.getElementById('byproduct');
                if (getActiveIndex(1) == 6) // Thermal
                    byproduct.innerHTML = 'Heat';
                else if (getActiveIndex(1) == 3)
                    byproduct.innerHTML = 'None';
                else
                    byproduct.innerHTML = 'GAS';

            }

            for (let toggle of toggle_groups) {
                let btns = [...toggle.getElementsByClassName('toggle-btn')];
                groups.push(btns);

                btns.forEach(btn => btn.addEventListener('click', () => {
                    for (let b of btns) // 1 active button per group
                        b.classList.remove('active');
                    btn.classList.add('active');
                    update_genes();
                }));
            }

            // Default values
            update_genes();
        </script>

        <br>
        <small>
            * And fire resistance (slightly, will still burn)<br>
            * Cures VIRS<br>
            * Only resistance against being dissolved by SOAP, dead BCTR loses resistance. Also includes SALT<br>
            * Resistance to being mutated by radiation<br><br>
            * Includes DYST<br>
            * Includes WOOD and SAWD<br>
            * Includes BRAY<br>
            * Includes ELEC and PROT<br>
            * Less likely to eat other bacteria with this gene or with resistance<br>
            * Cools surroundings while boosting own temperature<br><br>
            * Cannot reproduce normally<br><br>
            * Default liquid graphics
        </small>


        <script>
            /* Automatically render elements with math class. If class display
             * is also included will render in display mode */
            let math = Array.from(document.getElementsByClassName('math'));
            for (let ele of math) {
                katex.render(ele.innerText, ele, {
                    throwOnError: false,
                    displayMode: ele.classList.contains('display')
                });
            }
        </script>
    </body>
</html>